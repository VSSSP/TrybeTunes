(this.webpackJsonptrybetunes=this.webpackJsonptrybetunes||[]).push([[0],{29:function(e,t,n){},40:function(e,t,n){"use strict";n.r(t);var a=n(1),r=n.n(a),c=n(21),s=n.n(c),i=(n(29),n(4)),o=n(5),u=n(7),d=n(6),l=n(13),j=n(3),h=n(2),b=n.n(h),p=n(8),f=n(0),O=function(e){Object(u.a)(n,e);var t=Object(d.a)(n);function n(){return Object(i.a)(this,n),t.apply(this,arguments)}return Object(o.a)(n,[{key:"render",value:function(){return Object(f.jsx)("div",{children:Object(f.jsx)("p",{children:"Carregando..."})})}}]),n}(a.Component),m=n(14),v="user",x=function(e){return localStorage.setItem(v,JSON.stringify(e))},g=function(e){return function(t){setTimeout((function(){t(e)}),1500)}},k=function(){return new Promise((function(e){var t=JSON.parse(localStorage.getItem(v));null===t&&(t={}),g(t)(e)}))},S=function(e){return new Promise((function(t){x(Object(m.a)(Object(m.a)({},{name:"",email:"",image:"",description:""}),e)),g("OK")(t)}))},y=function(e){return new Promise((function(t){x(Object(m.a)({},e)),g("OK")(t)}))},C=function(e){Object(u.a)(n,e);var t=Object(d.a)(n);function n(){var e;return Object(i.a)(this,n),(e=t.call(this)).getUser=Object(p.a)(b.a.mark((function t(){var n;return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.setState({load:!0}),t.next=3,k();case 3:n=t.sent,e.setState({user:n,load:!1});case 5:case"end":return t.stop()}}),t)}))),e.state={load:!1,user:{}},e}return Object(o.a)(n,[{key:"componentDidMount",value:function(){this.getUser()}},{key:"render",value:function(){var e=this.state,t=e.load,n=e.user;return t?Object(f.jsx)(O,{}):Object(f.jsxs)("header",{"data-testid":"header-component",children:[Object(f.jsx)("h1",{children:"Trybetunes"}),Object(f.jsx)("p",{"data-testid":"header-user-name",children:n.name}),Object(f.jsx)(l.b,{to:"/TrybeTunes/search","data-testid":"link-to-search",children:"Search"}),Object(f.jsxs)(l.b,{to:"/TrybeTunes/favorites","data-testid":"link-to-favorites",children:["Favorites"," "]}),Object(f.jsx)(l.b,{to:"/TrybeTunes/profile","data-testid":"link-to-profile",children:" Profile "})]})}}]),n}(a.Component),w=function(e){Object(u.a)(n,e);var t=Object(d.a)(n);function n(){var e;return Object(i.a)(this,n),(e=t.call(this)).handleCheckbox=function(){var t=Object(p.a)(b.a.mark((function t(n){var a,r,c,s;return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:a=n.target.checked,r=e.props,c=r.removeOrAddSongs,s=r.music,c(s,a);case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.state={load:!1},e}return Object(o.a)(n,[{key:"render",value:function(){var e=this.props.music,t=e.trackName,n=e.previewUrl,a=e.trackId,r=this.props.checked;return this.state.load?Object(f.jsx)(O,{}):Object(f.jsxs)("div",{children:[t,Object(f.jsxs)("audio",{"data-testid":"audio-component",src:n,controls:!0,children:[Object(f.jsx)("track",{kind:"captions"}),"O seu navegador n\xe3o suporta o elemento"," ",Object(f.jsx)("code",{children:"audio"}),"."]}),Object(f.jsxs)("label",{htmlFor:a,children:["Favorita",Object(f.jsx)("input",{name:"input",id:a,type:"checkbox","data-testid":"checkbox-music-".concat(a),onChange:this.handleCheckbox,checked:r})]})]})}}]),n}(a.Component),I=n(24),N="favorite_songs";JSON.parse(localStorage.getItem(N))||localStorage.setItem(N,JSON.stringify([]));var P=function(){return JSON.parse(localStorage.getItem(N))},T=function(e){return localStorage.setItem(N,JSON.stringify(e))},A=function(e){return function(t){setTimeout((function(){t(e)}),500)}},F=function(){return new Promise((function(e){var t=P();A(t)(e)}))},U=function(e){return new Promise((function(t){if(e){var n=P();T([].concat(Object(I.a)(n),[e]))}A("OK")(t)}))},J=function(e){return new Promise((function(t){var n=P();T(n.filter((function(t){return t.trackId!==e.trackId}))),A("OK")(t)}))},M=function(){var e=Object(p.a)(b.a.mark((function e(t){var n,a;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("https://itunes.apple.com/lookup?id=".concat(t,"&entity=song"));case 2:return n=e.sent,e.next=5,n.json();case 5:return a=e.sent,e.abrupt("return",a.results);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),D=M,z=function(e){Object(u.a)(n,e);var t=Object(d.a)(n);function n(){var e;return Object(i.a)(this,n),(e=t.call(this)).componentDidMount=function(){e.handleIdSongs(),e.handleFavoriteSongs()},e.handleIdSongs=Object(p.a)(b.a.mark((function t(){var n,a;return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.props.match.params.id,t.next=3,D(n);case 3:a=t.sent,e.setState({musics:a});case 5:case"end":return t.stop()}}),t)}))),e.handleFavoriteSongs=Object(p.a)(b.a.mark((function t(){var n;return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,F();case 2:n=t.sent,e.setState({favorites:n,load:!1});case 4:case"end":return t.stop()}}),t)}))),e.removeOrAddSongs=function(){var t=Object(p.a)(b.a.mark((function t(n,a){return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.setState({load:!0}),t.next=3,a?U(n):J(n);case 3:e.handleFavoriteSongs();case 4:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),e.state={musics:[],load:!0,favorites:[]},e}return Object(o.a)(n,[{key:"handleSection",value:function(e){var t=this,n=e.musics,a=e.favorites;return Object(f.jsxs)("section",{children:[Object(f.jsx)("p",{"data-testid":"artist-name",children:n[0].artistName}),Object(f.jsx)("p",{"data-testid":"album-name",children:n[0].collectionName}),n.slice(1).map((function(e){return Object(f.jsx)(w,{checked:a.some((function(t){return e.trackId===t.trackId})),music:e,removeOrAddSongs:t.removeOrAddSongs},e.collectionId)}))]})}},{key:"render",value:function(){var e=this.state.load;return Object(f.jsxs)("div",{"data-testid":"page-album",children:[Object(f.jsx)(C,{}),e?Object(f.jsx)(O,{}):this.handleSection(this.state)]})}}]),n}(a.Component),E=function(e){Object(u.a)(n,e);var t=Object(d.a)(n);function n(){var e;return Object(i.a)(this,n),(e=t.call(this)).handleFavoriteSongs=Object(p.a)(b.a.mark((function t(){var n;return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,F();case 2:n=t.sent,e.setState({favorites:n,load:!1});case 4:case"end":return t.stop()}}),t)}))),e.removeOrAddSongs=function(){var t=Object(p.a)(b.a.mark((function t(n,a){return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.setState({load:!0}),t.next=3,a?U(n):J(n);case 3:e.handleFavoriteSongs();case 4:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),e.state={load:!1,favorites:[]},e}return Object(o.a)(n,[{key:"componentDidMount",value:function(){this.handleFavoriteSongs()}},{key:"handleSection",value:function(e){var t=this,n=e.favorites;return Object(f.jsx)("section",{children:n.map((function(e){return Object(f.jsx)(w,{checked:n.some((function(t){return e.trackId===t.trackId})),music:e,removeOrAddSongs:t.removeOrAddSongs},e.collectionId)}))})}},{key:"render",value:function(){var e=this.state.load;return Object(f.jsxs)("div",{"data-testid":"page-favorites",children:[Object(f.jsx)(C,{}),e?Object(f.jsx)(O,{}):this.handleSection(this.state)]})}}]),n}(a.Component),G=n(15),K=function(e){Object(u.a)(n,e);var t=Object(d.a)(n);function n(){var e;return Object(i.a)(this,n),(e=t.call(this)).handleChange=function(t){var n=t.target,a=n.name,r=n.value;e.setState({criarUsuario:Object(G.a)({},a,r)})},e.handleClick=Object(p.a)(b.a.mark((function t(){var n;return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.state.criarUsuario,e.setState({load:!0}),t.next=4,S(n);case 4:e.setState({load:!1,redirect:!0});case 5:case"end":return t.stop()}}),t)}))),e.state={criarUsuario:{name:""},load:!1,redirect:!1},e}return Object(o.a)(n,[{key:"render",value:function(){var e=this.state,t=e.redirect,n=e.load,a=e.criarUsuario;return n?Object(f.jsx)(O,{}):t?Object(f.jsx)(j.a,{to:"/search"}):Object(f.jsx)("div",{"data-testid":"page-login",children:Object(f.jsx)("form",{children:Object(f.jsxs)("label",{htmlFor:"name",children:[Object(f.jsx)("input",{name:"name","data-testid":"login-name-input",onChange:this.handleChange}),Object(f.jsx)("button",{"data-testid":"login-submit-button",type:"button",disabled:a.name.length<3,onClick:this.handleClick,children:"Entrar"})]})})})}}]),n}(a.Component),B=function(e){Object(u.a)(n,e);var t=Object(d.a)(n);function n(){return Object(i.a)(this,n),t.apply(this,arguments)}return Object(o.a)(n,[{key:"render",value:function(){return Object(f.jsx)("div",{"data-testid":"page-not-found",children:Object(f.jsx)("p",{children:"Page Not Found"})})}}]),n}(a.Component),R=function(e){Object(u.a)(n,e);var t=Object(d.a)(n);function n(){var e;return Object(i.a)(this,n),(e=t.call(this)).handleGetUser=Object(p.a)(b.a.mark((function t(){var n;return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.setState({load:!0}),t.next=3,k();case 3:n=t.sent,e.setState({load:!1,user:n});case 5:case"end":return t.stop()}}),t)}))),e.userProfile=function(){var t=e.state.user,n=t.name,a=t.email,r=t.image,c=t.description;return Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)("p",{children:n}),Object(f.jsx)("p",{children:a}),Object(f.jsx)("img",{src:r,alt:"Profile","data-testid":"profile-image"}),Object(f.jsx)("p",{children:c})]})},e.state={load:!1,user:{}},e}return Object(o.a)(n,[{key:"componentDidMount",value:function(){this.handleGetUser()}},{key:"render",value:function(){var e=this.state.load;return Object(f.jsxs)("div",{"data-testid":"page-profile",children:[Object(f.jsx)(C,{}),e?Object(f.jsx)(O,{}):this.userProfile(),Object(f.jsx)(l.b,{to:"/TrybeTunes/profile/edit",children:" Editar perfil "})]})}}]),n}(a.Component),V=function(e){Object(u.a)(n,e);var t=Object(d.a)(n);function n(){var e;return Object(i.a)(this,n),(e=t.call(this)).handleGetUser=Object(p.a)(b.a.mark((function t(){var n;return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,k();case 2:n=t.sent,e.setState({load:!1,user:n});case 4:case"end":return t.stop()}}),t)}))),e.handleChange=function(t){var n=t.target,a=n.name,r=n.value;e.setState((function(e){var t=e.user;return{user:Object(m.a)(Object(m.a)({},t),{},Object(G.a)({},a,r))}}))},e.enableButton=function(){var t=e.state.user,n=Object.values(t);return n.length<4||(!e.emailValidation()||n.some((function(e){return!e.length})))},e.emailValidation=function(){var t=e.state.user.email;return/^[a-z0-9.]+@[a-z0-9]+\.[a-z]+(\.[a-z]+)?$/i.test(t)},e.handleClick=Object(p.a)(b.a.mark((function t(){var n;return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.state.user,e.setState({load:!0}),t.next=4,y(n);case 4:e.setState({load:!1,redirect:!0});case 5:case"end":return t.stop()}}),t)}))),e.state={load:!0,user:{name:"",email:"",description:"",image:""}},e}return Object(o.a)(n,[{key:"componentDidMount",value:function(){this.handleGetUser()}},{key:"editProfileForm",value:function(){var e=this.state.user,t=e.name,n=e.email,a=e.image,r=e.description;return Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)("input",{"data-testid":"edit-input-name",type:"text",value:t,name:"name",onChange:this.handleChange}),Object(f.jsx)("input",{"data-testid":"edit-input-email",type:"text",value:n,name:"email",onChange:this.handleChange}),Object(f.jsx)("input",{"data-testid":"edit-input-description",type:"text",value:r,name:"description",onChange:this.handleChange}),Object(f.jsx)("input",{"data-testid":"edit-input-image",type:"text",value:a,name:"image",onChange:this.handleChange}),Object(f.jsxs)("button",{"data-testid":"edit-button-save",type:"button",disabled:this.enableButton(),onClick:this.handleClick,children:[" ","Salvar"," "]})]})}},{key:"render",value:function(){var e=this.state,t=e.load;return e.redirect?Object(f.jsx)(j.a,{to:"/TrybeTunes/profile"}):Object(f.jsxs)("div",{"data-testid":"page-profile-edit",children:[Object(f.jsx)(C,{}),t?Object(f.jsx)(O,{}):this.editProfileForm()]})}}]),n}(a.Component),q=function(e){Object(u.a)(n,e);var t=Object(d.a)(n);function n(){return Object(i.a)(this,n),t.apply(this,arguments)}return Object(o.a)(n,[{key:"render",value:function(){var e=this.props,t=e.artworkUrl100,n=e.collectionName,a=e.artistName,r=e.collectionId;return Object(f.jsx)("div",{children:Object(f.jsxs)("div",{children:[Object(f.jsx)("img",{width:"150px",src:t,alt:"".concat(n," de ").concat(a)}),Object(f.jsx)(l.b,{to:"/TrybeTunes/album/".concat(r),"data-testid":"link-to-album-".concat(r),children:n})]},t)})}}]),n}(a.Component),$=function(){var e=Object(p.a)(b.a.mark((function e(t){var n,a,r,c,s,i;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=encodeURI(t).replaceAll("%20","+"),a="https://itunes.apple.com/search?entity=album&term=".concat(n,"&attribute=allArtistTerm"),e.next=4,fetch(a);case 4:return r=e.sent,e.next=7,r.json();case 7:return c=e.sent,s=c.results,i=s.map((function(e){return{artistId:e.artistId,artistName:e.artistName,collectionId:e.collectionId,collectionName:e.collectionName,collectionPrice:e.collectionPrice,artworkUrl100:e.artworkUrl100,releaseDate:e.releaseDate,trackCount:e.trackCount}})),e.abrupt("return",i);case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),_=$,H=function(e){Object(u.a)(n,e);var t=Object(d.a)(n);function n(){var e;return Object(i.a)(this,n),(e=t.call(this)).handleChange=function(t){var n=t.target,a=n.name,r=n.value;e.setState(Object(G.a)({},a,r))},e.handleClick=Object(p.a)(b.a.mark((function t(){var n,a;return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.state.searchInput,e.setState({load:!0,artistName:n}),t.next=4,_(n);case 4:a=t.sent,e.setState({searchAlbuns:a,loadAPI:!0,load:!1,searchInput:""});case 6:case"end":return t.stop()}}),t)}))),e.handleStateCondition=function(t){var n=t.loadAPI,a=t.searchAlbuns,r=t.load,c=t.artistName;return r?Object(f.jsx)(O,{}):n&&!a.length?Object(f.jsx)("p",{children:"Nenhum \xe1lbum foi encontrado"}):n?Object(f.jsxs)("div",{children:[Object(f.jsx)("p",{children:"Resultado de \xe1lbuns de: ".concat(c)}),e.handleAlbumMap(a)]},"a"):void 0},e.state={searchInput:"",load:!1,searchAlbuns:{},loadAPI:!1},e}return Object(o.a)(n,[{key:"handleAlbumMap",value:function(e){return e.map((function(e){return Object(a.createElement)(q,Object(m.a)(Object(m.a)({},e),{},{key:e.trackId}))}))}},{key:"render",value:function(){var e=this.state.searchInput;return Object(f.jsxs)("div",{"data-testid":"page-search",children:[Object(f.jsx)(C,{}),Object(f.jsxs)("label",{htmlFor:"searchInput",children:[Object(f.jsx)("input",{name:"searchInput","data-testid":"search-artist-input",onChange:this.handleChange,value:e}),Object(f.jsx)("button",{"data-testid":"search-artist-button",type:"button",disabled:e.length<2,onClick:this.handleClick,children:"Pesquisar"})]}),this.handleStateCondition(this.state)]})}}]),n}(a.Component),L=function(e){Object(u.a)(n,e);var t=Object(d.a)(n);function n(){return Object(i.a)(this,n),t.apply(this,arguments)}return Object(o.a)(n,[{key:"render",value:function(){return Object(f.jsx)(l.a,{basename:"/TrybeTunes",children:Object(f.jsxs)(j.d,{children:[Object(f.jsx)(j.b,{exact:!0,path:"/",component:K}),Object(f.jsx)(j.b,{path:"/search",component:H}),Object(f.jsx)(j.b,{path:"/album/:id",component:z}),Object(f.jsx)(j.b,{path:"/favorites",component:E}),Object(f.jsx)(j.b,{path:"/profile/edit",component:V}),Object(f.jsx)(j.b,{path:"/profile",component:R}),Object(f.jsx)(j.b,{component:B})]})})}}]),n}(r.a.Component),Q=L;s.a.render(Object(f.jsx)(r.a.StrictMode,{children:Object(f.jsx)(Q,{})}),document.getElementById("root"))}},[[40,1,2]]]);
//# sourceMappingURL=main.a439d4d6.chunk.js.map